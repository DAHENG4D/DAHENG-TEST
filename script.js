// script.js

document.addEventListener('DOMContentLoaded', () => {
    // --- Existing code for smooth scrolling and mobile navigation toggle (KEEP THIS) ---
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', function (e) {
            e.preventDefault();
            document.querySelector(this.getAttribute('href')).scrollIntoView({
                behavior: 'smooth'
            });
            const navbarLinks = document.querySelector('.nav-links');
            const hamburgerMenu = document.getElementById('hamburger-menu');
            if (navbarLinks && navbarLinks.classList.contains('active')) {
                navbarLinks.classList.remove('active');
                if (hamburgerMenu) hamburgerMenu.classList.remove('active');
            }
        });
    });

    const hamburgerMenu = document.getElementById('hamburger-menu');
    const navbarLinks = document.querySelector('.nav-links');
    if (hamburgerMenu && navbarLinks) {
        hamburgerMenu.addEventListener('click', () => {
            navbarLinks.classList.toggle('active');
            hamburgerMenu.classList.toggle('active');
        });
    }

    // --- NEW FUNCTION TO CLEAR NUMBERS AND SET A PLACEHOLDER ---
    function resetNumbersToPlaceholder() {
        const allNumberCells = document.querySelectorAll(
            '.prize-number, .results-table.special-table tbody td, .results-table.consolation-table tbody td'
        );
        allNumberCells.forEach(cell => {
            cell.textContent = "-";
        });
    }

    // --- NEW FUNCTION FOR THE SLOW REVEAL EFFECT ---
    function slowReveal(elements, values, delay) {
        let i = 0;
        function revealNext() {
            if (i < elements.length) {
                elements[i].textContent = values[i];
                i++;
                setTimeout(revealNext, delay);
            }
        }
        revealNext();
    }

    // --- YOUR CUSTOM FUNCTION FOR UPDATING DRAW NUMBERS ---
    function updateDrawNumbers() {
        console.log("Updating draw numbers with YOUR GENERATED RESULTS!");

        // Example: Replace these lines with your actual logic
        const newFirstPrize = "1234";
        const newSecondPrize = "5678";
        const newThirdPrize = "9012";
        const newSpecialResults = ["1111", "2222", "3333", "4444", "5555", "6666", "7777", "8888", "9999", "0000"];
        const newConsolationResults = ["1010", "2020", "3030", "4040", "5050", "6060", "7070", "8080", "9090", "0101"];
        const newJackpot1 = "RM 7,500,000.00";
        const newJackpot2 = "RM 250,000.00";
        const newDrawDate = "Thu 07-08-2025";
        const newDrawNo = "No.5951/25";

        // Step 1: Update metadata instantly
        document.querySelector('.jackpot-item:nth-child(1) .jackpot-amount').textContent = newJackpot1;
        document.querySelector('.jackpot-item:nth-child(2) .jackpot-amount').textContent = newJackpot2;
        document.querySelector('.draw-date').textContent = newDrawDate;
        document.querySelector('.draw-no').textContent = newDrawNo;
        document.querySelector('.results-main-section .section-description').textContent = `Here are the latest official results for ${newDrawDate} (Draw ${newDrawNo}).`;

        // Step 2: Clear all number fields to placeholder just before the reveal
        resetNumbersToPlaceholder();

        // Step 3: Gather all the elements in the desired reveal order
        const allNumberElements = [
            document.querySelector('.prize-section.top-prizes .prize-row:nth-child(1) .prize-number'),
            document.querySelector('.prize-section.top-prizes .prize-row:nth-child(2) .prize-number'),
            document.querySelector('.prize-section.top-prizes .prize-row:nth-child(3) .prize-number'),
            ...document.querySelectorAll('.results-table.special-table tbody td'),
            ...document.querySelectorAll('.results-table.consolation-table tbody td')
        ];

        // Step 4: Combine the new values into one array in the same order
        const allNewValues = [
            newFirstPrize,
            newSecondPrize,
            newThirdPrize,
            ...newSpecialResults,
            ...newConsolationResults
        ];

        // Step 5: Start the slow reveal with a 5-second delay between each number
        const revealDelay = 5000; // 5000 milliseconds = 5 seconds
        slowReveal(allNumberElements, allNewValues, revealDelay);

        console.log("Draw numbers update process started!");
    }

    // --- Scheduling the Next Result ---
    function scheduleNextResult(hour, minute, second) {
        const now = new Date();
        const updateTime = new Date(now.getFullYear(), now.getMonth(), now.getDate(), hour, minute, second);

        if (updateTime.getTime() < now.getTime()) {
            updateTime.setDate(updateTime.getDate() + 1);
        }

        const timeToWait = updateTime.getTime() - now.getTime();
        console.log(`Next result update scheduled for: ${updateTime.toLocaleString()} (in ${timeToWait / 1000} seconds)`);

        setTimeout(() => {
            updateDrawNumbers();
            scheduleNextResult(hour, minute, second);
        }, timeToWait);
    }

    // --- NEW: TRANSLATION DICTIONARIES ---
    const translations = {
        en: {
            pageTitle: "DAHENG 4D - Best Lottery Best Prize !",
            brandName: "DAHENG 4D",
            navHome: "Home",
            navResults: "Results",
            navHowToPlay: "How to Play",
            navPrize: "Prize",
            navAbout: "About Us",
            navContact: "Contact",
            heroHeading: "Dream Big, Win Big!",
            heroSubheading: "Check the latest DA-HENG 4D results and play your lucky numbers today.",
            heroHowToPlay: "How to Play",
            heroLatestResults: "Latest Results",
            resultsHeading: "Official DAHENG 4D Results",
            resultsDescription: "Here are the latest official results for Thu 18-09-2025 ",
            prizeLabel1: "1st Prize",
            prizeLabel2: "2nd Prize",
            prizeLabel3: "3rd Prize",
            tableSpecial: "Special",
            tableConsolation: "Consolation",
            jackpotLabel1: "4D jackpot 1",
            jackpotLabel2: "4D jackpot 2",
            viewPastResults: "View Past Results",
            nextDrawCountdown: "Next Draw Countdown",
            howToPlayHeading: "How to Play Daheng 4D",
            step1Heading: "1. Choose Your Numbers",
            step1Description: "Select any 4-digit number from 0000 to 9999. You can also choose 'Lucky Pick' for a randomly generated number.",
            step2Heading: "2. Select Your Bet Type",
            step2Description: "Choose 'Big' (permissible, ordinary, or sum) or 'Small' (permissible only) according to your preference.",
            step3Heading: "3. Place Your Bet",
            step3Description: "Decide on your bet amount for each chosen number and bet type. Minimum bet is RM 1.",
            step4Heading: "4. Check Results",
            step4Description: "Draws are held three times a week. Check back here for the latest results and see if you've won!",
            learnMore: "Learn More",
            newsHeading: "Latest News & Announcements",
            newsItem1Heading: "Exciting New Game Coming Soon!",
            newsItem1Date: "August 5, 2025",
            newsItem1Description: "Stay tuned for an announcement about a brand new lottery game with even bigger jackpots!",
            newsItem2Heading: "Daheng Community Outreach Program",
            newsItem2Date: "July 28, 2025",
            newsItem2Description: "We're proud to support local communities through our latest CSR initiatives. Find out more.",
            readMore: "Read More",
            viewAllNews: "View All News",
            aboutHeading: "About Daheng 4D",
            aboutParagraph1: "Da-Heng 4D is one of the leading lottery operators, committed to providing fair and transparent games. We are dedicated to responsible gaming and contribute significantly to social welfare through our charitable initiatives. Since our inception, we have been a part of millions of dreams and winners' stories.",
            aboutParagraph2: "Our commitment extends beyond just lottery games; we strive to make a positive impact on society, supporting various community projects and welfare organizations.",
            ourStory: "Our Story",
            brandNameFooter: "DAHENG 4D",
            footerTagline: "Dream Big, Win Bigger!",
            footerQuickLinks: "Quick Links",
            navHomeFooter: "Home",
            navResultsFooter: "Latest Results",
            navHowToPlayFooter: "How to Play",
            navNewsFooter: "News & Events",
            footerSupport: "Support",
            supportFAQ: "FAQ",
            supportContact: "Contact Us",
            supportGaming: "Responsible Gaming",
            supportPrivacy: "Privacy Policy",
            footerContactUs: "Contact Us",
            contactAddress: "Lottery Lane, Kuala Lumpur, Malaysia",
            contactEmail: "info@daheng4d.my",
            copyright: "Â© 2025 Daheng 4D. All Rights Reserved. For 18+ only. Play Responsibly.",
            disclaimer: "Disclaimer: This is a fictional website for demonstration purposes. Actual lottery results and information may vary."
        },
        ms: {
            pageTitle: "DAHENG 4D - Loteri Terbaik, Hadiah Terhebat!",
            brandName: "DAHENG 4D",
            navHome: "Laman Utama",
            navResults: "Keputusan",
            navHowToPlay: "Cara Bermain",
            navPrize: "Hadiah",
            navAbout: "Tentang Kami",
            navContact: "Hubungi Kami",
            heroHeading: "Impian Besar, Menang Besar!",
            heroSubheading: "Semak keputusan 4D DA-HENG terkini dan main nombor bertuah anda hari ini.",
            heroHowToPlay: "Cara Bermain",
            heroLatestResults: "Keputusan Terkini",
            resultsHeading: "Keputusan Rasmi DAHENG 4D",
            resultsDescription: "Berikut adalah keputusan rasmi terkini untuk Khamis 18-09-2025",
            prizeLabel1: "Hadiah Pertama",
            prizeLabel2: "Hadiah Kedua",
            prizeLabel3: "Hadiah Ketiga",
            tableSpecial: "Khas",
            tableConsolation: "Saguh hati",
            jackpotLabel1: "Jackpot 4D 1",
            jackpotLabel2: "Jackpot 4D 2",
            viewPastResults: "Lihat Keputusan Lalu",
            nextDrawCountdown: "Kiraan Detik Cabutan Seterusnya",
            howToPlayHeading: "Cara Bermain Daheng 4D",
            step1Heading: "1. Pilih Nombor Anda",
            step1Description: "Pilih mana-mana nombor 4 digit dari 0000 hingga 9999. Anda juga boleh memilih 'Pilihan Bertuah' untuk nombor yang dijana secara rawak.",
            step2Heading: "2. Pilih Jenis Pertaruhan Anda",
            step2Description: "Pilih 'Besar' (dibenarkan, biasa, atau jumlah) atau 'Kecil' (dibenarkan sahaja) mengikut pilihan anda.",
            step3Heading: "3. Letakkan Pertaruhan Anda",
            step3Description: "Tentukan jumlah pertaruhan anda untuk setiap nombor dan jenis pertaruhan yang dipilih. Pertaruhan minimum ialah RM 1.",
            step4Heading: "4. Semak Keputusan",
            step4Description: "Cabutan diadakan tiga kali seminggu. Semak semula di sini untuk keputusan terkini dan lihat jika anda telah menang!",
            learnMore: "Ketahui Lebih Lanjut",
            newsHeading: "Berita & Pengumuman Terkini",
            newsItem1Heading: "Permainan Baharu yang Menarik Akan Datang!",
            newsItem1Date: "5 Ogos 2025",
            newsItem1Description: "Nantikan pengumuman tentang permainan loteri baharu dengan jackpot yang lebih besar!",
            newsItem2Heading: "Program Jangkauan Komuniti Daheng",
            newsItem2Date: "28 Julai 2025",
            newsItem2Description: "Kami bangga menyokong komuniti tempatan melalui inisiatif CSR terbaru kami. Ketahui lebih lanjut.",
            readMore: "Baca Lebih Lanjut",
            viewAllNews: "Lihat Semua Berita",
            aboutHeading: "Mengenai Daheng 4D",
            aboutParagraph1: "Da-Heng 4D adalah salah satu pengendali loteri terkemuka, komited untuk menyediakan permainan yang adil dan telus. Kami berdedikasi untuk permainan yang bertanggungjawab dan menyumbang secara signifikan kepada kebajikan sosial melalui inisiatif amal kami. Sejak penubuhan kami, kami telah menjadi sebahagian daripada jutaan impian dan kisah pemenang.",
            aboutParagraph2: "Komitmen kami melangkaui sekadar permainan loteri; kami berusaha untuk membuat impak positif kepada masyarakat, menyokong pelbagai projek komuniti dan organisasi kebajikan.",
            ourStory: "Kisah Kami",
            brandNameFooter: "DAHENG 4D",
            footerTagline: "Impian Besar, Menang Lebih Besar!",
            footerQuickLinks: "Pautan Pantas",
            navHomeFooter: "Laman Utama",
            navResultsFooter: "Keputusan Terkini",
            navHowToPlayFooter: "Cara Bermain",
            navNewsFooter: "Berita & Acara",
            footerSupport: "Sokongan",
            supportFAQ: "Soalan Lazim",
            supportContact: "Hubungi Kami",
            supportGaming: "Permainan Bertanggungjawab",
            supportPrivacy: "Dasar Privasi",
            footerContactUs: "Hubungi Kami",
            contactAddress: "Lottery Lane, Kuala Lumpur, Malaysia",
            contactEmail: "info@daheng4d.my",
            copyright: "Â© 2025 Daheng 4D. Semua Hak Cipta Terpelihara. Untuk 18+ sahaja. Main dengan Bertanggungjawab.",
            disclaimer: "Penafian: Ini adalah laman web fiksyen untuk tujuan demonstrasi. Keputusan loteri sebenar dan maklumat mungkin berbeza."
        },
        zh: {
            pageTitle: "DAHENG 4D - æå¥½çå½©ç¥¨ï¼ææ£çå¥åï¼",
            brandName: "DAHENG 4D",
            navHome: "ä¸»é¡µ",
            navResults: "å¼å½©æç»©",
            navHowToPlay: "å¦ä½ç©",
            navPrize: "å¥é",
            navAbout: "å³äºæä»¬",
            navContact: "èç³»æä»¬",
            heroHeading: "æ¢¦æ³è¶å¤§ï¼ä¸­å¥è¶å¤§ï¼",
            heroSubheading: "æ¥è¯¢ææ°çDA-HENG 4Då¼å½©æç»©ï¼ä»å¤©å°±ç©ä½ çå¹¸è¿å·ç å§ã",
            heroHowToPlay: "å¦ä½ç©",
            heroLatestResults: "ææ°å¼å½©",
            resultsHeading: "DAHENG 4Då®æ¹å¼å½©æç»©",
            resultsDescription: "ä»¥ä¸æ¯2025å¹´9æ18æ¥ææå çææ°å®æ¹å¼å½©æç»©ã",
            prizeLabel1: "å¤´å¥",
            prizeLabel2: "äºå¥",
            prizeLabel3: "ä¸å¥",
            tableSpecial: "ç¹å«å¥",
            tableConsolation: "å®æ°å¥",
            jackpotLabel1: "4Dç§¯å® 1",
            jackpotLabel2: "4Dç§¯å® 2",
            viewPastResults: "æ¥çè¿å¾æç»©",
            nextDrawCountdown: "ä¸ä¸æ¬¡å¼å½©åè®¡æ¶",
            howToPlayHeading: "å¦ä½ç©Daheng 4D",
            step1Heading: "1. éæ©ä½ çå·ç ",
            step1Description: "éæ©ä»»ä½ä¸ä¸ª0000å°9999ä¹é´ç4ä½æ°å·ç ãæ¨ä¹å¯ä»¥éæ©'å¹¸è¿éå·'æ¥éæºçæå·ç ã",
            step2Heading: "2. éæ©ä½ çä¸æ³¨ç±»å",
            step2Description: "æ ¹æ®æ¨çåå¥½éæ©âå¤§âï¼å¯äºæ¢ãæ®éææ»åï¼æâå°âï¼ä»éå¯äºæ¢ï¼ã",
            step3Heading: "3. ä¸æ³¨",
            step3Description: "å³å®æ¨ä¸ºæ¯ä¸ªéå®å·ç åä¸æ³¨ç±»åä¸æ³¨çéé¢ãæä½ä¸æ³¨éé¢ä¸ºRM 1ã",
            step4Heading: "4. æ¥çæç»©",
            step4Description: "æ¯å¨ä¸¾è¡ä¸æ¬¡å¼å½©ãè¯·åå°è¿éæ¥çææ°æç»©ï¼ççæ¨æ¯å¦ä¸­å¥ï¼",
            learnMore: "äºè§£æ´å¤",
            newsHeading: "ææ°æ¶æ¯ä¸å¬å",
            newsItem1Heading: "æ¿å¨äººå¿çæ°æ¸¸æå³å°æ¨åºï¼",
            newsItem1Date: "2025å¹´8æ5æ¥",
            newsItem1Description: "æ¬è¯·æå¾å³äºä¸æ¬¾å¨æ°å½©ç¥¨æ¸¸æçå¬åï¼å¥éå°æ´å ä¸°åï¼",
            newsItem2Heading: "å¤§æç¤¾åºå¤å±è®¡å",
            newsItem2Date: "2025å¹´7æ28æ¥",
            newsItem2Description: "æä»¬å¾èªè±ªéè¿ææ°çä¼ä¸ç¤¾ä¼è´£ä»»ï¼CSRï¼ä¸¾æªæ¥æ¯æå½å°ç¤¾åºãäºè§£æ´å¤ä¿¡æ¯ã",
            readMore: "éè¯»æ´å¤",
            viewAllNews: "æ¥çæææ°é»",
            aboutHeading: "å³äºDaheng 4D",
            aboutParagraph1: "Da-Heng 4Dæ¯é¢åçå½©ç¥¨è¿è¥åä¹ä¸ï¼è´åäºæä¾å¬å¹³éæçæ¸¸æãæä»¬è´åäºè´è´£ä»»çåå½©ï¼å¹¶éè¿æä»¬çæåæ´»å¨ä¸ºç¤¾ä¼ç¦å©ååºéå¤§è´¡ç®ãèªæç«ä»¥æ¥ï¼æä»¬ä¸ç´æ¯æ°ç¾ä¸ä¸ªæ¢¦æ³åä¸­å¥æäºçä¸é¨åã",
            aboutParagraph2: "æä»¬çæ¿è¯ºä¸ä»ä»å±éäºå½©ç¥¨æ¸¸æï¼æä»¬åªåå¯¹ç¤¾ä¼äº§çç§¯æå½±åï¼æ¯æåç§ç¤¾åºé¡¹ç®åç¦å©ç»ç»ã",
            ourStory: "æä»¬çæäº",
            brandNameFooter: "DAHENG 4D",
            footerTagline: "æ¢¦æ³è¶å¤§ï¼ä¸­å¥è¶å¤§ï¼",
            footerQuickLinks: "å¿«éé¾æ¥",
            navHomeFooter: "ä¸»é¡µ",
            navResultsFooter: "ææ°å¼å½©",
            navHowToPlayFooter: "å¦ä½ç©",
            navNewsFooter: "æ°é»ä¸æ´»å¨",
            footerSupport: "æ¯æ",
            supportFAQ: "å¸¸è§é®é¢",
            supportContact: "èç³»æä»¬",
            supportGaming: "è´è´£ä»»åå½©",
            supportPrivacy: "éç§æ¿ç­",
            footerContactUs: "èç³»æä»¬",
            contactAddress: "å½©ç¥¨å··ï¼åéå¡ï¼é©¬æ¥è¥¿äº",
            contactEmail: "info@daheng4d.my",
            copyright: "Â© 2025 Daheng 4Dãçæææãä»é18å²ä»¥ä¸ãè´è´£ä»»åå½©ã",
            disclaimer: "åè´£å£°æï¼è¿æ¯ä¸ä¸ªç¨äºæ¼ç¤ºç®ççèæç½ç«ãå®éçå½©ç¥¨ç»æåä¿¡æ¯å¯è½ä¼ææä¸åã"
        }
    };

    // --- NEW: FUNCTION TO UPDATE TEXT BASED ON LANGUAGE ---
    function setLanguage(lang) {
        const elements = document.querySelectorAll('[data-i18n]');
        elements.forEach(el => {
            const key = el.getAttribute('data-i18n');
            if (translations[lang] && translations[lang][key]) {
                el.textContent = translations[lang][key];
            }
        });

        // Handle special cases that aren't simple textContent updates
        document.title = translations[lang].pageTitle;

        // Special case for results description which includes variables
        const currentDrawDate = document.querySelector('.draw-date').textContent;
        const currentDrawNo = document.querySelector('.draw-no').textContent;
        if (lang === 'en') {
            document.querySelector('.results-main-section .section-description').textContent = `Here are the latest official results for ${currentDrawDate}.`;
        } else if (lang === 'ms') {
            document.querySelector('.results-main-section .section-description').textContent = `Berikut adalah keputusan rasmi terkini untuk ${currentDrawDate}.`;
        } else if (lang === 'zh') {
            document.querySelector('.results-main-section .section-description').textContent = `ä»¥ä¸æ¯${currentDrawDate} çææ°å®æ¹å¼å½©æç»©ã`;
        }
    }

    // --- NEW: LANGUAGE SWITCHER EVENT LISTENER ---
    const langSelect = document.getElementById('lang-select');
    if (langSelect) {
        langSelect.addEventListener('change', (event) => {
            setLanguage(event.target.value);
        });
    }

    // --- INITIALIZE THE PAGE WITH THE DEFAULT LANGUAGE (English) ---
    // Get the preferred language from local storage, or default to English
    const userPreferredLang = localStorage.getItem('lang') || 'en';
    setLanguage(userPreferredLang);
    if (langSelect) {
        langSelect.value = userPreferredLang;
    }

    // --- CALL THIS FUNCTION TO SCHEDULE YOUR NEXT DRAW ---
    scheduleNextResult(21, 0, 0); // 9 PM
});
